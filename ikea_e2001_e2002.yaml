blueprint:
  name: IKEA E2001/E2002 - STYRBAR remote control
  description: Use the IKEA E2001/E2002 remote control via Zigbee2MQTT
  domain: automation
  input:
    remote:
      name: Remote
      description: Select your IKEA remote device
      selector:
        device:
          multiple: false
    target_light:
      name: Light
      description: Select the light to control
      selector:
        entity:
          domain: light
    button_right:
      name: Action for right button (up)
      default: []
      selector:
        action: {}
    button_left:
      name: Action for left button (down)
      default: []
      selector:
        action: {}

mode: restart
max_exceeded: silent

trigger:
  - platform: device
    device_id: !input remote
    domain: mqtt
    type: action

action:
  - variables:
      action: "{{ trigger.payload }}"
  - choose:
      - conditions: "{{ action == 'on' }}"
        sequence:
          - service: light.turn_on
            target:
              entity_id: !input target_light

      - conditions: "{{ action == 'off' }}"
        sequence:
          - service: light.turn_off
            target:
              entity_id: !input target_light

      - conditions: "{{ action == 'arrow_left_click' }}"
        sequence: !input button_left

      - conditions: "{{ action == 'arrow_right_click' }}"
        sequence: !input button_right
